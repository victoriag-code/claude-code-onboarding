<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claude Code Enterprise Setup Wizard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #F5F3F0 0%, #E6DDD4 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            line-height: 1.6;
        }

        .wizard-container {
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            max-width: 800px;
            width: 100%;
            overflow: hidden;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .wizard-header {
            background: #D4A574;
            color: #1A1A1A;
            padding: 30px;
            text-align: center;
        }

        .wizard-header h1 {
            font-size: 2em;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .wizard-header p {
            opacity: 0.8;
            font-size: 0.95em;
        }

        .progress-bar {
            height: 4px;
            background: rgba(26, 26, 26, 0.2);
            position: relative;
            margin-top: 20px;
        }

        .progress-fill {
            height: 100%;
            background: #1A1A1A;
            transition: width 0.3s ease;
            border-radius: 2px;
        }

        .wizard-content {
            padding: 40px;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .step-content {
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateX(10px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .step-title {
            font-size: 1.5em;
            font-weight: 600;
            margin-bottom: 20px;
            color: #1A1A1A;
        }

        .button-grid {
            display: grid;
            gap: 15px;
            margin-top: 30px;
        }

        .option-button {
            background: #F5F3F0;
            border: 2px solid #D4A574;
            border-radius: 8px;
            padding: 20px;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option-button:hover {
            background: #D4A574;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(212, 165, 116, 0.3);
        }

        .option-button h3 {
            font-size: 1.2em;
            margin-bottom: 5px;
        }

        .option-button p {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #E6DDD4;
        }

        .nav-button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-button.back {
            background: #F5F3F0;
            color: #1A1A1A;
        }

        .nav-button.back:hover {
            background: #E6DDD4;
        }

        .nav-button.next {
            background: #D4A574;
            color: white;
        }

        .nav-button.next:hover {
            background: #C09868;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(212, 165, 116, 0.3);
        }

        .nav-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: flex;
            align-items: center;
            font-weight: 500;
            margin-bottom: 8px;
            color: #1A1A1A;
        }

        .tooltip {
            display: inline-block;
            margin-left: 8px;
            cursor: help;
            position: relative;
        }

        .tooltip-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #D4A574;
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .tooltip-content {
            display: none;
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #1A1A1A;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.85em;
            white-space: nowrap;
            max-width: 300px;
            z-index: 1000;
            margin-bottom: 5px;
        }

        .tooltip:hover .tooltip-content {
            display: block;
            white-space: normal;
        }

        .tooltip-content::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 5px solid transparent;
            border-top-color: #1A1A1A;
        }

        .form-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #E6DDD4;
            border-radius: 6px;
            font-size: 0.95em;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #D4A574;
        }

        .form-input.error {
            border-color: #e74c3c;
        }

        .error-message {
            color: #e74c3c;
            font-size: 0.85em;
            margin-top: 5px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        select.form-input {
            cursor: pointer;
        }

        textarea.form-input {
            resize: vertical;
            min-height: 100px;
        }

        .info-box {
            background: #F9F7F5;
            border-left: 4px solid #D4A574;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        .info-box h3 {
            color: #1A1A1A;
            margin-bottom: 10px;
        }

        .info-box ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        .info-box li {
            margin-bottom: 8px;
        }

        .action-box {
            background: #FFF9F3;
            border: 2px solid #D4A574;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
        }

        .action-box h4 {
            color: #1A1A1A;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .action-box a {
            color: #D4A574;
            text-decoration: none;
            font-weight: 500;
            display: inline-block;
            margin-top: 10px;
        }

        .action-box a:hover {
            text-decoration: underline;
        }

        .link-box {
            background: #F5F3F0;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .link-box p {
            font-weight: 500;
            color: #1A1A1A;
        }

        .link-box a {
            color: #D4A574;
            text-decoration: none;
            font-weight: 500;
        }

        .link-box a:hover {
            text-decoration: underline;
        }

        .end-screen {
            text-align: center;
            padding: 20px;
        }

        .success-icon {
            font-size: 4em;
            color: #27ae60;
            margin-bottom: 20px;
        }

        .quick-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }

        .quick-link {
            background: #F5F3F0;
            padding: 15px;
            border-radius: 8px;
            text-decoration: none;
            color: #1A1A1A;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .quick-link:hover {
            background: #D4A574;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(212, 165, 116, 0.3);
        }

        .summary-box {
            background: #F9F7F5;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #E6DDD4;
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .summary-label {
            font-weight: 600;
            color: #666;
        }

        .summary-value {
            color: #1A1A1A;
        }

        .licensing-options {
            display: grid;
            gap: 20px;
            margin: 20px 0;
        }

        .license-card {
            border: 2px solid #E6DDD4;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .license-card:hover {
            border-color: #D4A574;
            box-shadow: 0 5px 15px rgba(212, 165, 116, 0.2);
        }

        .license-card.selected {
            border-color: #D4A574;
            background: #FFF9F3;
        }

        .license-card h3 {
            color: #1A1A1A;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .license-card .price {
            color: #D4A574;
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .license-card ul {
            list-style: none;
            margin-top: 15px;
        }

        .license-card li {
            padding: 5px 0;
            padding-left: 25px;
            position: relative;
        }

        .license-card li::before {
            content: '✓';
            position: absolute;
            left: 0;
            color: #27ae60;
            font-weight: bold;
        }

        .radio-indicator {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 20px;
            height: 20px;
            border: 2px solid #D4A574;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .radio-indicator::after {
            content: '';
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #D4A574;
            display: none;
        }

        .license-card.selected .radio-indicator::after {
            display: block;
        }

        .notice-box {
            background: #FFF3E0;
            border: 1px solid #FFB74D;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }

        .notice-box strong {
            color: #E65100;
        }

        /* Modal styles */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 9999;
            animation: fadeIn 0.3s ease;
        }

        .modal-overlay.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideInModal 0.3s ease;
        }

        @keyframes slideInModal {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .modal-header {
            margin-bottom: 20px;
        }

        .modal-header h3 {
            color: #1A1A1A;
            font-size: 1.5em;
            margin: 0;
        }

        .modal-body {
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .modal-button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .modal-button.primary {
            background: #D4A574;
            color: white;
        }

        .modal-button.primary:hover {
            background: #C09868;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(212, 165, 116, 0.3);
        }

        .modal-button.secondary {
            background: #F5F3F0;
            color: #1A1A1A;
        }

        .modal-button.secondary:hover {
            background: #E6DDD4;
        }

        .modal-notice {
            background: #FFF3E0;
            border: 1px solid #FFB74D;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .modal-notice strong {
            color: #E65100;
        }
    </style>
</head>
<body>
    <!-- Modal Overlay -->
    <div id="modal-overlay" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Important</h3>
            </div>
            <div class="modal-body" id="modal-body">
                <!-- Content will be inserted here -->
            </div>
            <div class="modal-footer" id="modal-footer">
                <button class="modal-button primary" onclick="closeModal()">Continue</button>
            </div>
        </div>
    </div>

    <div class="wizard-container">
        <div class="wizard-header">
            <h1>Claude Code for Your Team</h1>
            <p id="header-description">Get your development team started with AI-powered coding assistance</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progress" style="width: 10%"></div>
            </div>
        </div>

        <div class="wizard-content">
            <div id="step-content" class="step-content">
                <!-- Content will be dynamically inserted here -->
            </div>

            <div class="nav-buttons">
                <button class="nav-button back" id="back-btn" onclick="previousStep()" style="display: none">
                    ← Back
                </button>
                <button class="nav-button next" id="next-btn" onclick="nextStep()">
                    Get Started →
                </button>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 0;
        let selectedLicense = null;
        let selectedAccessMethod = null;
        let customerData = {};

        // Modal functions
        function showModal(title, content, buttons = null) {
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-body').innerHTML = content;

            const footer = document.getElementById('modal-footer');
            if (buttons) {
                footer.innerHTML = buttons;
            } else {
                footer.innerHTML = '<button class="modal-button primary" onclick="closeModal()">Continue</button>';
            }

            document.getElementById('modal-overlay').classList.add('active');
        }

        function closeModal() {
            document.getElementById('modal-overlay').classList.remove('active');
        }

        const baseSteps = [
            {
                title: 'Welcome to Claude Code Setup',
                type: 'info',
                content: `
                    <div class="info-box">
                        <h3>Let's get your team started with Claude Code!</h3>
                        <p>This wizard will help you set up Claude Code for your development team in just a few minutes.</p>
                        <p style="margin-top: 10px;"><strong>What is Claude Code?</strong></p>
                        <p>Claude Code is an AI-powered coding assistant that helps your developers write better code faster, debug issues, and accelerate development workflows.</p>
                    </div>
                    <div class="action-box">
                        <h4>What we'll help you with:</h4>
                        <ul style="margin-left: 20px;">
                            <li>Choose the right licensing option for your team</li>
                            <li>Set up your organization account</li>
                            <li>Configure single sign-on (SSO) for easy access</li>
                            <li>Understand billing and usage management</li>
                        </ul>
                    </div>
                `
            },
            {
                title: 'Choose Your Licensing Option',
                type: 'licensing',
                content: `
                    <p style="margin-bottom: 20px;">Select the option that best fits your team's needs:</p>
                    <div class="licensing-options">
                        <div class="license-card" onclick="selectLicense('per-user')">
                            <div class="radio-indicator"></div>
                            <h3>Per-User License
                                <span class="tooltip">
                                    <span class="tooltip-icon">?</span>
                                    <span class="tooltip-content">Fixed monthly cost per developer with unlimited usage within fair use limits</span>
                                </span>
                            </h3>
                            <div class="price">$200/month per developer</div>
                            <p>Best for teams wanting predictable costs and maximum features</p>
                            <ul>
                                <li>Unlimited code completions and chat</li>
                                <li>Includes Claude for Enterprise access</li>
                                <li>Priority support</li>
                                <li>No usage monitoring needed</li>
                            </ul>
                        </div>

                        <div class="license-card" onclick="selectLicense('api-token')">
                            <div class="radio-indicator"></div>
                            <h3>API Token (Pay-as-you-go)
                                <span class="tooltip">
                                    <span class="tooltip-icon">?</span>
                                    <span class="tooltip-content">Pay only for what you use, billed by API tokens consumed</span>
                                </span>
                            </h3>
                            <div class="price">~$60-100/month per developer</div>
                            <p>Flexible option for teams wanting to control costs</p>
                            <ul>
                                <li>Pay only for actual usage</li>
                                <li>Set spending limits per workspace</li>
                                <li>Detailed usage analytics</li>
                                <li>Start immediately with no commitment</li>
                            </ul>
                        </div>
                    </div>
                `
            },
            {
                title: 'Tell Us About Your Team',
                type: 'form',
                fields: [
                    {
                        id: 'company_name',
                        label: 'Company Name',
                        type: 'text',
                        placeholder: 'Enter your company name',
                        required: true
                    },
                    {
                        id: 'your_name',
                        label: 'Your Name',
                        type: 'text',
                        placeholder: 'Enter your full name',
                        required: true
                    },
                    {
                        id: 'email',
                        label: 'Work Email Address',
                        type: 'email',
                        placeholder: 'you@company.com',
                        required: true
                    },
                    {
                        id: 'role',
                        label: 'Your Role',
                        type: 'select',
                        options: ['Engineering Manager', 'Team Lead', 'CTO/VP Engineering', 'IT Administrator', 'Developer', 'Other'],
                        required: true
                    },
                    {
                        id: 'team_size',
                        label: 'Development Team Size',
                        type: 'select',
                        options: ['Under 100', '101-300', '301-500', '501-1000', '1000+'],
                        required: true,
                        tooltip: 'Include all developers who will use Claude Code'
                    },
                    {
                        id: 'timeline',
                        label: 'When do you want to get started?',
                        type: 'select',
                        options: ['Immediately', 'Within a month', 'Just exploring'],
                        required: true
                    },
                    {
                        id: 'current_tools',
                        label: 'Current AI coding tools (if any)',
                        type: 'textarea',
                        placeholder: 'e.g., GitHub Copilot, Cursor, none',
                        required: false,
                        tooltip: 'This helps us understand your team\'s experience with AI coding assistants'
                    }
                ]
            },
        ];

        const apiSetupStep = {
            title: 'Choose Your Access Method',
            type: 'api-method-selection',
            content: `
                <div class="info-box">
                    <h3>How will you access Claude Code?</h3>
                    <p>Select your preferred API access method:</p>
                </div>

                <div class="licensing-options" style="margin-bottom: 30px;">
                    <div class="license-card" onclick="selectAccessMethod('first-party')">
                        <div class="radio-indicator"></div>
                        <h3>First-Party API (Direct)
                            <span class="tooltip">
                                <span class="tooltip-icon">?</span>
                                <span class="tooltip-content">Access Claude Code directly through Anthropic's API and Console</span>
                            </span>
                        </h3>
                        <p>Use Anthropic's Console and API directly</p>
                        <ul>
                            <li>Full Console dashboard access</li>
                            <li>Usage monitoring and analytics</li>
                            <li>Direct API key management</li>
                        </ul>
                    </div>

                    <div class="license-card" onclick="selectAccessMethod('bedrock')">
                        <div class="radio-indicator"></div>
                        <h3>AWS Bedrock
                            <span class="tooltip">
                                <span class="tooltip-icon">?</span>
                                <span class="tooltip-content">Access Claude Code through your existing AWS Bedrock integration</span>
                            </span>
                        </h3>
                        <p>Use your existing AWS infrastructure</p>
                        <ul>
                            <li>Integrated with AWS services</li>
                            <li>AWS billing and monitoring</li>
                            <li>Enterprise AWS agreements</li>
                        </ul>
                    </div>

                    <div class="license-card" onclick="selectAccessMethod('vertex')">
                        <div class="radio-indicator"></div>
                        <h3>Google Cloud Vertex AI
                            <span class="tooltip">
                                <span class="tooltip-icon">?</span>
                                <span class="tooltip-content">Access Claude Code through Google Cloud's Vertex AI platform</span>
                            </span>
                        </h3>
                        <p>Use your existing GCP infrastructure</p>
                        <ul>
                            <li>Integrated with GCP services</li>
                            <li>Google Cloud billing</li>
                            <li>Enterprise GCP agreements</li>
                        </ul>
                    </div>
                </div>
            `
        };

        const apiDetailsStep = {
            title: 'Access Method Details',
            type: 'api-details',
            content: '' // Will be dynamically populated based on selection
        };

        const ssoStep = {
            title: 'Single Sign-On (SSO) Information',
                type: 'info',
                content: `
                    <div class="info-box">
                        <h3>About SSO for Claude Code</h3>
                        <p>Single Sign-On allows your team to access Claude Code using your existing company credentials (like Google Workspace, Okta, or Microsoft Azure AD).</p>

                        <h4 style="margin-top: 15px;">Benefits of SSO:</h4>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>No separate passwords to remember</li>
                            <li>Automatic user provisioning</li>
                            <li>Centralized access control</li>
                            <li>Enhanced security</li>
                        </ul>
                    </div>

                    <div class="info-box" style="background: #FFF9F3; border-left-color: #FFB74D;">
                        <h3>You'll set up SSO after completing this form</h3>
                        <p>After we process your information, you'll receive detailed instructions for configuring SSO. This typically takes 15-30 minutes.</p>
                        <p style="margin-top: 10px;">We'll provide:</p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>Step-by-step SSO setup guide</li>
                            <li>Support contact for any issues</li>
                            <li>Role auto-provisioning instructions</li>
                        </ul>
                    </div>
                `
        };

        const billingStep = {
            title: 'Managing Costs and Usage',
                type: 'billing',
                content: `
                    <div class="info-box">
                        <h3>Understanding Your Billing</h3>
                        <div id="billing-info"></div>
                    </div>

                    <div id="billing-content"></div>
                `
        };

        // Dynamic steps array that will be built based on user choices
        let steps = [];

        function initWizard() {
            // Build initial steps (up to license selection)
            steps = [...baseSteps];
            showStep(0);
        }

        function buildStepsBasedOnLicense() {
            // Start with base steps
            steps = [...baseSteps];

            // Add steps based on license type
            if (selectedLicense === 'api-token') {
                // API Token users need to set up access method first
                steps.push(apiSetupStep);
                // We'll add SSO and billing steps after access method is selected
            }
            // Per-user license customers go straight to completion after form
            // Sales team will handle SSO, billing, etc.

            // Update progress bar as steps may have changed
            if (currentStep >= 0) {
                const progress = document.getElementById('progress');
                const progressPercent = ((currentStep + 1) / steps.length) * 100;
                progress.style.width = progressPercent + '%';
            }
        }

        function buildStepsBasedOnAccessMethod() {
            // Rebuild steps including the appropriate final steps based on access method
            steps = [...baseSteps];

            if (selectedLicense === 'api-token') {
                steps.push(apiSetupStep);
                steps.push(apiDetailsStep); // Add the details step

                // Only add SSO step for first-party API users
                if (selectedAccessMethod === 'first-party') {
                    steps.push(ssoStep);
                }

                // All API token users get billing step
                steps.push(billingStep);
            }

            // Update progress bar
            if (currentStep >= 0) {
                const progress = document.getElementById('progress');
                const progressPercent = ((currentStep + 1) / steps.length) * 100;
                progress.style.width = progressPercent + '%';
            }
        }

        function selectLicense(type) {
            selectedLicense = type;
            customerData.license_type = type;

            // Update UI
            document.querySelectorAll('.license-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');

            // Show modal with important information
            if (type === 'per-user') {
                showModal(
                    'Important: Per-User License',
                    `
                    <div class="modal-notice">
                        <strong>Sales Team Will Contact You</strong>
                    </div>
                    <p>You've selected the per-user license option ($200/month per developer).</p>
                    <p style="margin-top: 15px;"><strong>What happens next:</strong></p>
                    <ul style="margin-left: 20px;">
                        <li>Complete this short form (2 more steps)</li>
                        <li>Our sales team will contact you soon</li>
                        <li>They'll help set up your per-user licensing</li>
                        <li>They'll provide full onboarding support</li>
                    </ul>
                    <p style="margin-top: 15px;">Click Continue to proceed with the setup form.</p>
                    `
                );
            } else {
                showModal(
                    'API Token (Pay-as-you-go)',
                    `
                    <p>You've selected the API token option with pay-as-you-go pricing.</p>
                    <p style="margin-top: 15px;"><strong>Benefits:</strong></p>
                    <ul style="margin-left: 20px;">
                        <li>Start using Claude Code immediately</li>
                        <li>Pay only for what you use (~$60-100/month per developer)</li>
                        <li>Set spending limits to control costs</li>
                        <li>No long-term commitment required</li>
                    </ul>
                    <p style="margin-top: 15px;">Click Continue to proceed with the setup.</p>
                    `
                );
            }

            // Enable next button
            document.getElementById('next-btn').disabled = false;

            // Rebuild steps based on license selection
            buildStepsBasedOnLicense();
        }

        function selectAccessMethod(method) {
            selectedAccessMethod = method;
            customerData.access_method = method;

            // Update UI
            document.querySelectorAll('.license-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');

            // Enable next button
            document.getElementById('next-btn').disabled = false;

            // Rebuild steps based on access method selection
            buildStepsBasedOnAccessMethod();
        }

        function validateForm() {
            const formGroups = document.querySelectorAll('.form-group');
            let isValid = true;

            formGroups.forEach(group => {
                const input = group.querySelector('.form-input');
                const errorMsg = group.querySelector('.error-message');

                if (input && input.hasAttribute('data-required') && input.getAttribute('data-required') === 'true') {
                    if (!input.value.trim()) {
                        input.classList.add('error');
                        if (errorMsg) {
                            errorMsg.classList.add('show');
                        }
                        isValid = false;
                    } else {
                        input.classList.remove('error');
                        if (errorMsg) {
                            errorMsg.classList.remove('show');
                        }
                    }
                }
            });

            return isValid;
        }

        function saveFormData() {
            const formGroups = document.querySelectorAll('.form-group');
            formGroups.forEach(group => {
                const input = group.querySelector('.form-input');
                if (input && input.id) {
                    customerData[input.id] = input.value;
                }
            });
        }

        function showStep(stepIndex) {
            const content = document.getElementById('step-content');
            const backBtn = document.getElementById('back-btn');
            const nextBtn = document.getElementById('next-btn');
            const progress = document.getElementById('progress');

            if (stepIndex >= 0 && stepIndex < steps.length) {
                const step = steps[stepIndex];
                currentStep = stepIndex;

                // Update progress bar
                const progressPercent = ((stepIndex + 1) / steps.length) * 100;
                progress.style.width = progressPercent + '%';

                // Show/hide back button
                backBtn.style.display = stepIndex > 0 ? 'block' : 'none';

                // Update next button
                if (stepIndex === steps.length - 1) {
                    nextBtn.textContent = 'Complete Setup →';
                } else {
                    nextBtn.textContent = 'Continue →';
                }

                // Handle different step types
                if (step.type === 'form') {
                    let formHtml = `<div class="step-title">${step.title}</div>`;

                    step.fields.forEach(field => {
                        formHtml += `
                            <div class="form-group">
                                <label class="form-label">
                                    ${field.label}
                                    ${field.required ? '<span style="color: red;">*</span>' : ''}
                                    ${field.tooltip ? `
                                        <span class="tooltip">
                                            <span class="tooltip-icon">?</span>
                                            <span class="tooltip-content">${field.tooltip}</span>
                                        </span>
                                    ` : ''}
                                </label>
                        `;

                        if (field.type === 'select') {
                            formHtml += `
                                <select class="form-input" id="${field.id}" data-required="${field.required}">
                                    <option value="">Select an option...</option>
                            `;
                            field.options.forEach(option => {
                                formHtml += `<option value="${option}">${option}</option>`;
                            });
                            formHtml += '</select>';
                        } else if (field.type === 'textarea') {
                            formHtml += `
                                <textarea class="form-input" id="${field.id}"
                                    placeholder="${field.placeholder || ''}"
                                    data-required="${field.required}"></textarea>
                            `;
                        } else {
                            formHtml += `
                                <input type="${field.type}" class="form-input" id="${field.id}"
                                    placeholder="${field.placeholder || ''}"
                                    data-required="${field.required}">
                            `;
                        }

                        formHtml += `
                                <div class="error-message">This field is required</div>
                            </div>
                        `;
                    });

                    content.innerHTML = formHtml;

                    // Restore saved values if any
                    step.fields.forEach(field => {
                        if (customerData[field.id]) {
                            const element = document.getElementById(field.id);
                            if (element) {
                                element.value = customerData[field.id];
                            }
                        }
                    });
                } else if (step.type === 'licensing') {
                    content.innerHTML = `<div class="step-title">${step.title}</div>${step.content}`;
                    nextBtn.disabled = !selectedLicense;
                } else if (step.type === 'api-method-selection') {
                    content.innerHTML = `<div class="step-title">${step.title}</div>${step.content}`;
                    nextBtn.disabled = !selectedAccessMethod;
                } else if (step.type === 'api-details') {
                    // Dynamically populate content based on selected access method
                    let detailsContent = '';

                    if (customerData.access_method === 'first-party') {
                        detailsContent = `
                            <div class="info-box">
                                <h3>First-Party API Setup</h3>
                                <p>You'll access Claude Code directly through Anthropic's Console and API.</p>

                                <h4 style="margin-top: 15px;">What you'll need to do after this wizard:</h4>
                                <ul style="margin-left: 20px; margin-top: 10px;">
                                    <li>Create your Console account</li>
                                    <li>Generate API keys for your developers</li>
                                    <li>Configure SSO for your organization</li>
                                    <li>Set up workspace spending limits</li>
                                </ul>
                            </div>

                            <div class="action-box">
                                <h4>Organization ID (Optional)</h4>
                                <p>If you already have a Console account, enter your Organization UUID below. Otherwise, leave this blank and we'll help you create one after completing this form.</p>
                                <div class="form-group" style="margin-top: 15px;">
                                    <input type="text" class="form-input" id="org_uuid" placeholder="e.g., org_1234567890abcdef (optional)">
                                </div>
                            </div>
                        `;
                    } else if (customerData.access_method === 'bedrock') {
                        detailsContent = `
                            <div class="info-box">
                                <h3>AWS Bedrock Setup</h3>
                                <p>You'll access Claude Code through your existing AWS Bedrock integration.</p>

                                <h4 style="margin-top: 15px;">What you'll need to do after this wizard:</h4>
                                <ol style="margin-left: 20px; margin-top: 10px; line-height: 1.8;">
                                    <li>Ensure Claude models are enabled in your AWS Bedrock console</li>
                                    <li>Configure IAM permissions for your developers</li>
                                    <li>Use the AWS SDK or Bedrock API to access Claude Code</li>
                                    <li>Set up AWS billing alerts and budgets</li>
                                </ol>
                            </div>

                            <div class="action-box">
                                <h4>Important Note</h4>
                                <p>Billing and usage monitoring will be handled through your AWS account. You won't have access to Anthropic's Console dashboard.</p>
                                <p style="margin-top: 10px;">After completing this form, you'll receive instructions for AWS Bedrock setup.</p>
                            </div>
                        `;
                    } else if (customerData.access_method === 'vertex') {
                        detailsContent = `
                            <div class="info-box">
                                <h3>Google Cloud Vertex AI Setup</h3>
                                <p>You'll access Claude Code through Google Cloud's Vertex AI platform.</p>

                                <h4 style="margin-top: 15px;">What you'll need to do after this wizard:</h4>
                                <ol style="margin-left: 20px; margin-top: 10px; line-height: 1.8;">
                                    <li>Enable the Vertex AI API in your GCP project</li>
                                    <li>Configure authentication and permissions</li>
                                    <li>Use the Vertex AI SDK to access Claude Code</li>
                                    <li>Set up Google Cloud billing alerts</li>
                                </ol>
                            </div>

                            <div class="action-box">
                                <h4>Important Note</h4>
                                <p>Billing and usage monitoring will be handled through your Google Cloud account. You won't have access to Anthropic's Console dashboard.</p>
                                <p style="margin-top: 10px;">After completing this form, you'll receive instructions for Vertex AI setup.</p>
                            </div>
                        `;
                    }

                    content.innerHTML = `<div class="step-title">${step.title}</div>${detailsContent}`;
                    nextBtn.disabled = false;
                } else if (step.type === 'billing') {
                    content.innerHTML = `<div class="step-title">${step.title}</div>${step.content}`;
                    nextBtn.disabled = false;

                    // Update billing info
                    const billingInfo = document.getElementById('billing-info');
                    if (billingInfo) {
                        if (customerData.license_type === 'per-user') {
                            billingInfo.innerHTML = `
                                <p><strong>Your Selection: Per-User License</strong></p>
                                <ul style="margin-left: 20px; margin-top: 10px;">
                                    <li>$200/month per developer</li>
                                    <li>Billed monthly</li>
                                    <li>Includes unlimited usage within fair use limits</li>
                                    <li>A sales representative will contact you to finalize licensing</li>
                                </ul>
                            `;
                        } else {
                            billingInfo.innerHTML = `
                                <p><strong>Your Selection: API Token (Pay-as-you-go)</strong></p>
                                <ul style="margin-left: 20px; margin-top: 10px;">
                                    <li>Average: $60-100/month per developer</li>
                                    <li>Billed based on actual usage</li>
                                    <li>Can set spending caps</li>
                                    <li>Monthly invoicing available</li>
                                </ul>
                            `;
                        }
                    }

                    // Update billing content based on access method
                    const billingContent = document.getElementById('billing-content');
                    if (billingContent) {
                        if (customerData.access_method === 'first-party') {
                            billingContent.innerHTML = `
                                <div class="action-box">
                                    <h4>What you'll do after setup:</h4>
                                    <ul style="margin-left: 20px; margin-top: 10px;">
                                        <li>Set monthly spending caps for each workspace</li>
                                        <li>Monitor usage through the Console dashboard</li>
                                        <li>Configure billing alerts</li>
                                        <li>Review monthly invoices</li>
                                    </ul>
                                    <p style="margin-top: 15px;">You'll receive detailed instructions for managing costs after completing this form.</p>
                                </div>
                            `;
                        } else if (customerData.access_method === 'bedrock') {
                            billingContent.innerHTML = `
                                <div class="action-box">
                                    <h4>AWS Billing Management</h4>
                                    <p>Your Claude Code usage will be billed through AWS.</p>
                                    <p style="margin-top: 10px;">What you'll do after setup:</p>
                                    <ul style="margin-left: 20px; margin-top: 10px;">
                                        <li>Set up AWS Budgets for cost control</li>
                                        <li>Use CloudWatch for usage monitoring</li>
                                        <li>Configure billing alerts in AWS Cost Explorer</li>
                                    </ul>
                                    <p style="margin-top: 15px;">You'll receive AWS-specific billing instructions after completing this form.</p>
                                </div>
                            `;
                        } else if (customerData.access_method === 'vertex') {
                            billingContent.innerHTML = `
                                <div class="action-box">
                                    <h4>Google Cloud Billing Management</h4>
                                    <p>Your Claude Code usage will be billed through Google Cloud.</p>
                                    <p style="margin-top: 10px;">What you'll do after setup:</p>
                                    <ul style="margin-left: 20px; margin-top: 10px;">
                                        <li>Set up budget alerts in Google Cloud Console</li>
                                        <li>Use Cloud Monitoring for usage tracking</li>
                                        <li>Configure spending limits per project</li>
                                    </ul>
                                    <p style="margin-top: 15px;">You'll receive GCP-specific billing instructions after completing this form.</p>
                                </div>
                            `;
                        }
                    }
                } else {
                    content.innerHTML = `<div class="step-title">${step.title}</div>${step.content}`;
                    nextBtn.disabled = false;
                }
            }
        }

        function nextStep() {
            const currentStepData = steps[currentStep];

            if (currentStepData && currentStepData.type === 'form') {
                if (!validateForm()) {
                    return;
                }
                saveFormData();
            } else if (currentStepData && currentStepData.type === 'api-details') {
                // Save org_uuid only for first-party users
                if (customerData.access_method === 'first-party') {
                    const orgUuid = document.getElementById('org_uuid');
                    if (orgUuid) {
                        customerData.org_uuid = orgUuid.value;
                    }
                }
            }

            if (currentStep < steps.length - 1) {
                showStep(currentStep + 1);
            } else {
                completeSetup();
            }
        }

        function previousStep() {
            if (currentStep > 0) {
                showStep(currentStep - 1);
            }
        }

        async function completeSetup() {
            // Save any final data (org_uuid only exists for API token users with first-party access)
            if (customerData.license_type === 'api-token' && customerData.access_method === 'first-party') {
                const orgUuid = document.getElementById('org_uuid');
                if (orgUuid && orgUuid.value) {
                    customerData.org_uuid = orgUuid.value;
                }
            }

            // Add timestamp
            customerData.completed_at = new Date().toISOString();

            // Submit data to backend
            try {
                const response = await fetch('/api/submit-wizard', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(customerData)
                });

                if (!response.ok) {
                    console.error('Failed to submit data');
                }
            } catch (error) {
                console.error('Error submitting data:', error);
            }

            // Show completion screen
            showCompletionScreen();
        }

        function showCompletionScreen() {
            const content = document.getElementById('step-content');
            const backBtn = document.getElementById('back-btn');
            const nextBtn = document.getElementById('next-btn');
            const progress = document.getElementById('progress');

            progress.style.width = '100%';
            backBtn.style.display = 'none';
            nextBtn.style.display = 'none';

            let summaryHtml = '';
            if (Object.keys(customerData).length > 0) {
                summaryHtml = `
                    <div class="summary-box">
                        <h3>Setup Summary:</h3>
                `;

                const fieldLabels = {
                    'company_name': 'Company',
                    'your_name': 'Contact Name',
                    'email': 'Email',
                    'role': 'Role',
                    'team_size': 'Team Size',
                    'timeline': 'Timeline',
                    'license_type': 'Product Usage Model',
                    'access_method': 'Access Method',
                    'org_uuid': 'Organization ID'
                };

                for (const [key, value] of Object.entries(customerData)) {
                    if (value && fieldLabels[key]) {
                        let displayValue = value;

                        // Format specific values for display
                        if (key === 'license_type') {
                            displayValue = value === 'per-user' ? 'License' : 'API';
                        } else if (key === 'access_method') {
                            displayValue = {
                                'first-party': 'First-Party API (Direct)',
                                'bedrock': 'AWS Bedrock',
                                'vertex': 'Google Cloud Vertex AI'
                            }[value] || value;
                        }

                        summaryHtml += `
                            <div class="summary-item">
                                <span class="summary-label">${fieldLabels[key]}:</span>
                                <span class="summary-value">${displayValue}</span>
                            </div>
                        `;
                    }
                }

                summaryHtml += '</div>';
            }

            content.innerHTML = `
                <div class="end-screen">
                    <div class="success-icon">✓</div>
                    <div class="step-title">${customerData.license_type === 'per-user' ? 'Thank You!' : 'Setup Complete!'}</div>
                    <p>${customerData.license_type === 'per-user' ?
                        'Your information has been submitted. Our sales team will contact you soon to complete your Claude Code Enterprise setup with per-user licensing.' :
                        'Your Claude Code setup information has been recorded. You can now start using Claude Code with your API token.'}</p>

                    ${summaryHtml}

                    <div class="action-box" style="margin-top: 30px;">
                        <h4>${customerData.license_type === 'per-user' ? 'What Happens Next:' : 'Next Steps:'}</h4>
                        <ol style="margin-left: 20px; line-height: 2;">
                            ${customerData.license_type === 'per-user' ?
                                `<li>Our sales team will contact you soon</li>
                                <li>They will help you set up SSO for your organization</li>
                                <li>They will arrange per-user licensing ($200/month per developer)</li>
                                <li>They will provide onboarding support for your team</li>` :
                                `${customerData.access_method === 'first-party' ? '<li>Complete SSO setup if not already done</li>' : ''}
                                <li>Install Claude Code for your developers</li>
                                ${customerData.access_method === 'first-party' ? '<li>Set up workspace spending limits</li>' : '<li>Configure billing alerts in your cloud platform</li>'}
                                <li>Review the getting started guide</li>`
                            }
                        </ol>
                    </div>

                    ${customerData.license_type === 'per-user' ? '' : `
                    <div class="action-box" style="margin-top: 20px; background: #E8F5E9;">
                        <h4>🚀 Ready to Get Started!</h4>
                        <p>Your information has been submitted. Here are your setup resources:</p>
                        ${customerData.access_method === 'first-party' ? `
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><a href="https://console.anthropic.com" target="_blank">Create Console Account →</a></li>
                            <li><a href="https://support.anthropic.com/en/articles/11941803-setting-up-console-single-sign-on-with-claude-code-role-auto-provisioning" target="_blank">SSO Setup Guide →</a></li>
                            <li><a href="https://support.anthropic.com/en/articles/9796807-creating-and-managing-workspaces" target="_blank">Workspace Management Guide →</a></li>
                            <li><a href="https://console.anthropic.com/settings/usage" target="_blank">Usage Dashboard →</a></li>
                        </ul>
                        ` : customerData.access_method === 'bedrock' ? `
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><a href="https://docs.aws.amazon.com/bedrock/latest/userguide/model-access.html" target="_blank">AWS Bedrock Setup Guide →</a></li>
                            <li><a href="https://aws.amazon.com/aws-cost-management/" target="_blank">AWS Cost Management →</a></li>
                        </ul>
                        ` : `
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><a href="https://cloud.google.com/vertex-ai/docs" target="_blank">Vertex AI Setup Guide →</a></li>
                            <li><a href="https://cloud.google.com/billing/docs" target="_blank">GCP Billing Documentation →</a></li>
                        </ul>
                        `}
                    </div>

                    <div class="quick-links">
                        <a href="https://docs.anthropic.com/en/docs/claude-code/getting-started" target="_blank" class="quick-link">
                            📚 Documentation
                        </a>
                        <a href="https://docs.anthropic.com/en/docs/claude-code/costs" target="_blank" class="quick-link">
                            💰 Pricing Info
                        </a>
                        <a href="https://support.anthropic.com/en" target="_blank" class="quick-link">
                            🎫 Support Center
                        </a>
                    </div>
                    `}

                    <button class="nav-button next" style="margin-top: 30px; display: block; margin-left: auto; margin-right: auto;" onclick="location.reload()">
                        Start New Setup →
                    </button>
                </div>
            `;
        }

        // Initialize wizard on load
        window.addEventListener('DOMContentLoaded', initWizard);
    </script>
</body>
</html>